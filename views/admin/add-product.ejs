<%- include("../../views/partials/admin/header") %>

<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cropperjs@1.5.12/dist/cropper.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  <link rel="stylesheet" href="/styles/admin/addProduct.css">
</head>

<body>
  <section class="content-main" id="mainContent">
    <div class="content-wrapper">
      <h1 class="section-title">Add New Product</h1>

      <form id="productForm" enctype="multipart/form-data">
        <div id="cropModal" class="crop-modal">
          <div class="crop-modal-content">
            <span class="close-modal" onclick="closeCropModal()">Ã—</span>
            <h5>Crop Image</h5>
            <div class="crop-container">
              <img id="cropImage" src="" alt="Image to crop">
            </div>
            <div class="crop-buttons">
              <button class="crop-btn crop-btn-cancel" type="button" onclick="closeCropModal()">Cancel</button>
              <button class="crop-btn crop-btn-crop" type="button" id="cropBtn">Crop</button>
            </div>
          </div>
        </div>

        <div class="row">
          <div class="col-lg-8">
            <div class="card">
              <div class="card-header">
                <h5 class="card-title"><i class="fas fa-info-circle me-2"></i> Basic Information</h5>
              </div>
              <div class="card-body">
                <div class="form-section">
                  <div class="mb-4">
                    <label for="productName" class="form-label required-label">Product Name</label>
                    <input type="text" placeholder="Enter product name" name="productName" class="form-control" id="productName">
                    <div id="productName-error" class="error-message"></div>
                  </div>
                  <br>
                  <div class="row">
                    <div class="col-md-6 mb-4">
                      <label class="form-label required-label">Category</label>
                      <select class="form-select" name="category" id="category">
                        <% for(let i=0; i<cat.length; i++) { %>
                        <option value="<%= cat[i]._id %>"><%= cat[i].name %></option>
                        <% } %>
                      </select>
                      <div id="category-error" class="error-message"></div>
                    </div>
                    <br>
                    <div class="col-md-6 mb-4">
                      <label class="form-label required-label">Gender</label>
                      <select class="form-select" name="gender" id="gender">
                        <option value="">Select Gender</option>
                        <option value="Men">Men</option>
                        <option value="Women">Women</option>
                        <option value="Kids">Kids</option>
                        <option value="Unisex">Unisex</option>
                      </select>
                      <div id="gender-error" class="error-message"></div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-6 mb-4">
                      <label for="productType" class="form-label required-label">Fragrance Type</label>
                      <input type="text" placeholder="Enter Fragrance Type" name="productType" class="form-control" id="productType">
                      <div id="productType-error" class="error-message"></div>
                    </div>
                    <div class="col-md-6 mb-4">
                      <label for="fragranceFamily" class="form-label required-label">Fragrance Family</label>
                      <input type="text" placeholder="Enter Fragrance Family" name="fragranceFamily" class="form-control" id="fragranceFamily">
                      <div id="fragranceFamily-error" class="error-message"></div>
                    </div>
                  </div>
                  <div class="row">
                    <div class="col-md-6 mb-4">
                      <label for="longevity" class="form-label required-label">Fragrance Longevity</label>
                      <input type="text" placeholder="Enter Fragrance Longevity" name="longevity" class="form-control" id="longevity">
                      <div id="longevity-error" class="error-message"></div>
                    </div>
                    <div class="col-md-6 mb-4">
                      <label for="brand" class="form-label required-label">Brand</label>
                      <input type="text" placeholder="Enter Brand Name" name="brand" class="form-control" id="brand">
                      <div id="brand-error" class="error-message"></div>
                    </div>
                  </div>
                  <div class="mb-4">
                    <label for="usage" class="form-label required-label">Usage</label>
                    <input type="text" placeholder="Enter the Usage" name="usage" class="form-control" id="usage">
                    <div id="usage-error" class="error-message"></div>
                  </div>
                  <div class="mb-4">
                    <label for="shortDescription" class="form-label required-label">Short Description</label>
                    <input type="text" placeholder="Enter Short Product Description" name="shortDescription" class="form-control" id="shortDescription">
                    <div id="shortDescription-error" class="error-message"></div>
                  </div>
                </div>
                <div class="form-section">
                  <h6 class="form-section-title">Product Description</h6>
                  <div class="mb-4">
                    <textarea placeholder="Enter detailed product description" id="productDescription" name="description" class="form-control" rows="5"></textarea>
                    <div id="description-error" class="error-message"></div>
                  </div>
                </div>
              </div>
            </div>

            <div class="card">
              <div class="card-header">
                <h5 class="card-title"><i class="fas fa-cubes me-2"></i> Product Variants</h5>
              </div>
              <div class="card-body">
                <div id="variants-error" class="error-message"></div>
                <div id="variants-container">
                  <!-- Variant 1 -->
                  <div class="variant-section" id="variant-1">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                      <h6 class="form-section-title mb-0">Variant 1</h6>
                      <div class="variant-actions">
                        <button type="button" class="btn btn-sm btn-primary" id="add-variant-btn" onclick="addVariant()">
                          <i class="fas fa-plus"></i> Add Variant
                        </button>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-4 mb-4">
                        <label class="form-label required-label">Size</label>
                        <select class="form-select variant-size" name="variants[0][size]">
                          <option value="">Select Size</option>
                          <option value="20">20 ml</option>
                          <option value="50">50 ml</option>
                          <option value="100">100 ml</option>
                          <option value="150">150 ml</option>
                          <option value="200">200 ml</option>
                          <option value="250">250 ml</option>
                        </select>
                        <div class="error-message size-error"></div>
                      </div>
                      <div class="col-md-4 mb-4">
                        <label class="form-label required-label">SKU</label>
                        <input type="text" placeholder="SKU identifier" name="variants[0][sku]" class="form-control variant-sku">
                        <div class="error-message sku-error"></div>
                      </div>
                      <div class="col-md-4 mb-4">
                        <label class="form-label required-label">Quantity</label>
                        <input placeholder="Stock quantity" name="variants[0][quantity]" type="number" min="0" class="form-control variant-quantity">
                        <div class="error-message quantity-error"></div>
                      </div>
                    </div>
                    <div class="row">
                      <div class="col-md-6 mb-4">
                        <label class="form-label required-label">Price</label>
                        <div class="price-input-group">
                          <input placeholder="0.00" name="variants[0][salePrice]" type="number" step="0.01" min="0" class="form-control variant-sale-price">
                        </div>
                        <div class="error-message sale-price-error"></div>
                      </div>
                    </div>
                    <hr class="mb-4">
                  </div>
                </div>
              </div>
            </div>
          </div>

          <div class="col-lg-4">
            <div class="card">
              <div class="card-header">
                <h5 class="card-title"><i class="fas fa-images me-2"></i> Product Images</h5>
              </div>
              <div class="card-body">
                <label class="form-label required-label">Product Images (3 to 5 images):</label>
                <div class="image-upload-container">
                  <input type="file" name="images" id="productImages" accept="image/png, image/jpeg, image/jpg, image/webp" multiple onchange="handleFileSelect(event)">
                  <p>Click or drag to upload images (PNG, JPEG, WebP)</p>
                </div>
                <div id="images-error" class="error-message"></div>
                <div class="mt-2">
                  <span class="text-muted" style="font-size: 12px;">Only PNG, JPEG, and WebP formats supported</span>
                </div>
                <div id="croppedThumbnails" class="thumbnails-container"></div>
              </div>
            </div>

            <div class="card">
              <div class="card-body">
                <div class="button-group">
                  <a href="/admin/product" class="btn-back-inline" style="text-decoration: none;">
                    <i class="fas fa-arrow-left"></i> Back
                  </a>
                  <button class="btn btn-publish btn-publish-inline" type="submit" onclick="validateAndSubmit(event)">
                    <i class="fas fa-cloud-upload-alt"></i> Publish Product
                  </button>
                </div>
              </div>
            </div>
          </div>
        </div>
      </form>
    </div>
  </section>

  <button id="scrollTopBtn" class="scroll-top-btn" onclick="scrollToTop()">
    <i class="fas fa-arrow-up"></i>
  </button>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/cropperjs@1.5.12/dist/cropper.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <script src="/js/admin/addProduct.js"></script>
</body>

</html>